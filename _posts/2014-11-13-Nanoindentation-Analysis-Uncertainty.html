---
layout: post
title:  "Nanoindentation Automated Analysis Example"
author: jsweaver
date:   2014-11-13 16:00:00

---

We have defined some metrics for good analyses previously [http://tonyfast.com/nsf-goali/2014/10/24/Nanoindentation-Automated-Analysis-and-Uncertainty-Quantification/](http://tonyfast.com/nsf-goali/2014/10/24/Nanoindentation-Automated-Analysis-and-Uncertainty-Quantification/). This method still requires some manual selection to remove clusters of analyses that produce bad analyses.

## Baseline Analysis
- segment size (10:5:400)
- overlap requirement low (>10%)
- R2 for zero point low (>0.5)
- Modulus must be real
- No judgment on quality of stress-strain curve

## Analysis Work Flow ##
- iterate through segments with the three linear fits saving only necessary variables for filtering
- plot distributions 3D scatter plot of filtered analyses
- plot stress-strain curves of a few selected analyses particularly at the boundaries of the scatter plot
- iterate through filtering using the distributions and 3D scatter plot to determine cutoffs until the majority of the stress-strain curves are acceptable
- calculate stress-strain and plastic properties for all acceptable analyses
- verify yield strengths are correctly determined from offset or back extrapolated
- calculate the statistics of the modulus, yield strength, and hardening
- save work space

## Case Study ##
Sample is CPTi, 16um indenter radius, 2014-02-26 Batch #00002. 892 data points. 32,378 Analyses.
 
**Iteration 1** 
  
    Filt ={ 'Modulus', [1000 10]}

<a href="https://www.flickr.com/photos/125994770@N04/15782334945" title="Example Hist 1 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7524/15782334945_8a4ef218e5_b.jpg" width="1024" height="561" alt="Example Hist 1"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15783914772" title="Example Search 3 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7511/15783914772_5b0613afb2_b.jpg" width="1024" height="561" alt="Example Search 3"></a>

**Iteration 2**

	Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90}  

<a href="https://www.flickr.com/photos/125994770@N04/15162902653" title="Example Hist 2 by Jordan Weaver, on Flickr"><img src="https://farm9.staticflickr.com/8538/15162902653_e45c911dff_b.jpg" width="1024" height="561" alt="Example Hist 2"></a>

**Iteration 3**

    Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100}  
	  
<a href="https://www.flickr.com/photos/125994770@N04/15597175407" title="Example Hist 3 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5604/15597175407_e41c184700_b.jpg" width="1024" height="561" alt="Example Hist 3"></a>

Saved Search Scatter Plot and Example Stress-Strain Curves

<a href="https://www.flickr.com/photos/125994770@N04/15162383024" title="Example SS 3.1 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5608/15162383024_e9f2fa1648_b.jpg" width="1024" height="561" alt="Example SS 3.1"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15758649886" title="Example SS 3.2 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7518/15758649886_a4c22e0a26_b.jpg" width="1024" height="561" alt="Example SS 3.2"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15780469231" title="Example SS 3.3 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5604/15780469231_f236979397_b.jpg" width="1024" height="561" alt="Example SS 3.3"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15596514579" title="Example SS 3.4 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7503/15596514579_f8883a72fc_b.jpg" width="1024" height="561" alt="Example SS 3.4"></a>

**Iteration 4**

    Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001}

<a href="https://www.flickr.com/photos/125994770@N04/15596920488" title="Example Hist 4 by Jordan Weaver, on Flickr"><img src="https://farm9.staticflickr.com/8589/15596920488_680634833a_b.jpg" width="1024" height="561" alt="Example Hist 4"></a>

**Iteration 5**

    Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04} 

<a href="https://www.flickr.com/photos/125994770@N04/15596513979" title="Example Hist 5 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5615/15596513979_41b1fcdd01_b.jpg" width="1024" height="561" alt="Example Hist 5"></a>

**Iteration 6**
 
    Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04; 'MAR4', 0.1}

<a href="https://www.flickr.com/photos/125994770@N04/15596513909" title="Example Hist 6 by Jordan Weaver, on Flickr"><img src="https://farm9.staticflickr.com/8677/15596513909_331952afcc_b.jpg" width="1024" height="561" alt="Example Hist 6"></a>

**Iteration 7**

	Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04; 'MAR4', 0.1; 'p_change', [0.06 0]}

<a href="https://www.flickr.com/photos/125994770@N04/15782334635" title="Example Hist 7 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7489/15782334635_9ae536d6f4_b.jpg" width="1024" height="561" alt="Example Hist 7"></a>
Saved Search Scatter Plot and Example Stress-Strain Curves

<a href="https://www.flickr.com/photos/125994770@N04/15783914742" title="Example Search 6 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7554/15783914742_508a129711_b.jpg" width="1024" height="561" alt="Example Search 6"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15780469061" title="Example SS 6.1 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7542/15780469061_2f205a6878_b.jpg" width="1024" height="561" alt="Example SS 6.1"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15597531000" title="Example SS 6.2 by Jordan Weaver, on Flickr"><img src="https://farm9.staticflickr.com/8603/15597531000_7b7e5c255e_b.jpg" width="1024" height="561" alt="Example SS 6.2"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15783914322" title="Example SS 6.3 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5610/15783914322_1d3b67ace2_b.jpg" width="1024" height="561" alt="Example SS 6.3"></a>

Saved all Stress-Strain Data

		Estat = 
      mean: 100.0200
    median: 99.2786
     stdev: 4.6270
       min: 92.4900
       max: 118.6119

	Ystat = 
      mean: 0.8365
    median: 0.8220
     stdev: 0.0610
       min: 0.7394
       max: 1.0960

	Hstat = 
      mean: 13.4397
    median: 13.3776
     stdev: 1.4401
       min: 11.1772
       max: 19.1546

**Iteration 8**
	
	Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04; 'MAR4', 0.1; 'p_change', [0.06 0]; 'MAR2', 0.5}

<a href="https://www.flickr.com/photos/125994770@N04/15597530240" title="Example Hist 8 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7524/15597530240_602d3a2294_b.jpg" width="1024" height="561" alt="Example Hist 8"></a>

**Iteration 9**

	Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04; 'MAR4', 0.1; 'p_change', [0.06 0]; 'MAR2', 0.5; 'Hr', [-0.3 -0.5]}

Saved Search Scatter Plot and Example Stress-Strain Curves

<a href="https://www.flickr.com/photos/125994770@N04/15597176137" title="Example Search 8 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7538/15597176137_7dc88ee436_b.jpg" width="1024" height="561" alt="Example Search 8"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15162902993" title="Example SS 8.1 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5616/15162902993_6b5db45ce9_b.jpg" width="1024" height="561" alt="Example SS 8.1"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15162902913" title="Example SS 8.2 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7574/15162902913_fcb72e5a74_b.jpg" width="1024" height="561" alt="Example SS 8.2"></a>

<a href="https://www.flickr.com/photos/125994770@N04/15596920638" title="Example SS 8.3 by Jordan Weaver, on Flickr"><img src="https://farm6.staticflickr.com/5614/15596920638_b8e8f3dfea_b.jpg" width="1024" height="561" alt="Example SS 8.3"></a>

Saved all Stress-Strain Data

	Estat = 
      mean: 105.8270
    median: 105.7222
     stdev: 2.2997
       min: 100.9116
       max: 112.5039

	Ystat = 
      mean: 0.9153
    median: 0.9173
     stdev: 0.0325
       min: 0.8437
       max: 1.0199

	Hstat = 
      mean: 15.1464
    median: 14.9451
     stdev: 0.6875
       min: 13.9577
       max: 16.6392  

**Iteration 10**

	Filt ={ 'Modulus', [1000 10]; 'R21', 0.95; 'R22', 0.90; 'R23', 0.90; 'P*', 0.1100; 'dP', 0.001; 'MAR1', 0.04; 'MAR4', 0.09; 'p_change', [0.06 0]; 'MAR2', 0.49}

<a href="https://www.flickr.com/photos/125994770@N04/15597176207" title="Example Hist 10 by Jordan Weaver, on Flickr"><img src="https://farm8.staticflickr.com/7490/15597176207_a564a70760_b.jpg" width="1024" height="561" alt="Example Hist 10"></a>

Saved all Stress-Strain Data

	Estat = 
      mean: 105.2801
    median: 105.5839
     stdev: 2.4332
       min: 99.7603
       max: 110.0666

	Ystat = 
      mean: 0.9071
    median: 0.9156
     stdev: 0.0338
       min: 0.8320
       max: 0.9784

	Hstat = 
      mean: 15.0195
    median: 14.8722
     stdev: 0.7281
       min: 13.4207
       max: 16.2188

Progression of number of good analyses based on Filt variables for 10th iteration of Filt.

	npoints =
       32378
       32353
       13270
       12875
       11073
       11029
        9651
        8721
        2051
        2025
         434

There is not much more reasoning in filtering the data further

*note: Images labeled 6 and 8 are actually for iterations 7 and 9 and correctly positioned in this post.*

The matlab code and data used for this analysis can be found here:
[code and data](https://www.dropbox.com/sh/gkar3hcm2u7sq7o/AAA80RVHx92aXaaU78Uic7Zya?dl=0)
