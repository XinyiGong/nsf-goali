---
layout: post
title: ODF Matching through the use of Matlab's FMINCON
author: Noah Paulson, Dipen Patel

latex: true
autonumber: true

hex_fz360:
  type: img
  src: https://farm8.staticflickr.com/7579/15467931677_2e07a23708_o.png
---

### Problem Definition

We would like to select a limited number of crystalline orientations and their relative volume fractions in order to represent the ODF calculated from a much larger set of orientations. Specifically, we would like to select a set of less than 5000 orientations and associated volume fractions to match the ODF calculated from a EBSD map from a titanium alloy microstructure.

The Orientation Imaging (OIM) software can represent the ODF by a specified number of complex coefficients in **Generalized Spherical Harmonic** (GSH) functions. The truncation level of the GSH functions determines the number of coefficients and the resolution of the ODF.

A single crystal orientation can also be represented as an ODF through the use of GSH functions and their associated coefficients. Therefore, the set of volume fractions which best represent the experimental ODF are the weights in the linear combination of GSH coefficient sets (for each unique orientation) which minimize error with the refrence GSH coefficient set (for the experimental ODF). This relationship is expressed in the following equation,

$$
\begin{equation}
{minimize}_{v_i}  \big\{\sum\limits_{l=0}^L'  \big(\tilde{C}^L - \sum\limits_{i=1}^{N}v_iC_i^L\big)^2\big\}
\end{equation}
$$

* $ \tilde{C}^L $ : the set of reference GSH coefficients (from the experimental ODF)
* $ C_i^L $: the set of GSH coefficients use to represent the single crystal ODFs in GSH functions.

where $ L $ permutes $ l $, $\mu $ and $ \nu $.


The following conditions must be imposed to constrain the solution:

$$ \begin{equation} \sum\limits_{i=1}^N v_i = 1 \end{equation} $$

$$ \begin{equation} 0 \leq v_i \leq 1 \end{equation} $$

### Optimization Using FMINCON

The following equation is minimized using Matlab's FMINCON

    f = @(V) sum(conj(Y_coeff - X_coeff*V).*(Y_coeff - X_coeff*V) );
    [x,fval,exitflag,output] = fmincon(f,Vo,[],[],Aeq,beq,lb,ub,[],options);


* $ Y_{coeff} $: The set of GSH coefficients from the OIM software representing the actual ODF

* $ X_{coeff} $: An array of GSH coefficients for each selected oriention which have been properly scaled (details are shown in the next section)

* $ V $ : Vector of volume fractions associated with each selected orientation

The constraints on the solution were imposed as shown in the following Matlab code:

    % an initial guess for the volume fractions of each orientation
    Vo = (1/size(X_coeff,2))*ones(size(X_coeff,2),1);
    % Aeq * x = beq
    Aeq = ones(size(X_coeff,2),size(X_coeff,2));
    beq = ones(size(X_coeff,2),1);
    % lb =< x <= ub
    lb = zeros(size(X_coeff,2),1);
    ub = ones(size(X_coeff,2),1);

### Procedure to Perform ODF Matching

$$ \begin{equation} C_l^{\mu\nu} = \frac{2l + 1}{N}\sum\limits_{i=1}^N K\dot{\ddot{T}}_l^{\mu\nu}(g_i) \end{equation} $$



$$ \begin{equation} K =  \frac{e^{-0.25l^{2}w^{2}} - e^{-.25(l+1)^{2}w^{2}}}{1 -  e^{ -0.25w^{2}} } \end{equation} $$

where $ w $ is the gaussian half-width and

$ w = 5 $ degrees

### Selection of Orientations

* Orientations selected from Hexagonal-Triclinic fundamental zone ($ 0 \leq \phi_1 \leq 2\pi, 0 \leq \Phi < \frac{\pi}{2}, 0 \leq \phi_2 \leq \frac{\pi}{3}
$)

* The fundamental zone was uniformly binned and a single orientation was selected from the center of each bin for a total of 360 orientaions.
  * Bin spacing in $ \phi_1 = 24 $ degrees
  * Bin spacing in $ \Phi = 15 $ degrees
  * Bin spacing in $ \phi_2 = 12 $ degrees

_The image below shows the unique orientations selected from the hexagonal - triclinic fundamental zone_

{% include ContentManager.html content=page.hex_fz360 %}

